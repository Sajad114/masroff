<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØµØ§Ù†Ø¹ Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">

<style>
/* === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© === */
:root {
    --main-bg: #0f172a;
    --panel-bg: #1e293b;
    --border: rgba(255,255,255,0.1);
    --accent: #3b82f6;
    
    /* Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ®ØµÙŠØµ */
    --card-bg: #1e293b;
    --header-gradient-1: #15803d;
    --header-gradient-2: #22c55e;
    --table-head-bg: #0f172a;
    --table-head-text: #94a3b8;
    --row-even-bg: rgba(255,255,255,0.02);
    --row-hover: rgba(59, 130, 246, 0.1);
    
    /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù†ØµÙˆØµ */
    --col-brand: #e2e8f0;
    --col-size: #f59e0b;
    --col-price: #22c55e;
    --col-status: #94a3b8;
    
    /* Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø®Ø·ÙˆØ· */
    --font-scale: 1;
}

* { box-sizing: border-box; font-family: 'Cairo', sans-serif; }

body {
    background: var(--main-bg);
    color: #fff;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
}

.app-container {
    display: grid;
    grid-template-columns: 350px 1fr;
    gap: 0;
    width: 100%;
    min-height: 100vh;
}

/* === Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª) === */
.sidebar {
    background: var(--panel-bg);
    border-left: 1px solid var(--border);
    padding: 20px;
    overflow-y: auto;
    height: 100vh;
    box-shadow: 5px 0 15px rgba(0,0,0,0.3);
    z-index: 10;
}

.sidebar h2 { font-size: 18px; margin-bottom: 20px; color: var(--accent); display: flex; align-items: center; gap: 10px; }

.control-group { margin-bottom: 25px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
.control-group:last-child { border: none; }
.group-title { font-size: 14px; color: #94a3b8; margin-bottom: 10px; font-weight: bold; }

textarea {
    width: 100%;
    height: 120px;
    background: #020617;
    border: 1px solid var(--border);
    color: #fff;
    padding: 10px;
    border-radius: 8px;
    resize: vertical;
    font-size: 13px;
    margin-bottom: 10px;
}

textarea:focus { outline: none; border-color: var(--accent); }

.setting-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}
.setting-row label { font-size: 13px; color: #cbd5e1; }

input[type="color"] {
    -webkit-appearance: none;
    border: none;
    width: 30px;
    height: 30px;
    border-radius: 6px;
    cursor: pointer;
    background: none;
    padding: 0;
}
input[type="range"] { width: 100px; accent-color: var(--accent); }

.btn-primary {
    width: 100%;
    padding: 12px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
    transition: 0.2s;
}
.btn-success { background: #22c55e; color: #064e3b; }
button:hover { filter: brightness(1.1); }

/* === Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© === */
.preview-area {
    padding: 40px;
    display: flex;
    align-items: flex-start;
    justify-content: center;
    background: #0f172a;
    background-image: radial-gradient(#1e293b 1px, transparent 1px);
    background-size: 20px 20px;
    overflow-y: auto;
}

/* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© */
.price-card {
    width: 100%;
    max-width: 800px;
    background: var(--card-bg);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
    border: 1px solid rgba(255,255,255,0.05);
    position: relative;
}

.card-header {
    background: linear-gradient(135deg, var(--header-gradient-1), var(--header-gradient-2));
    padding: 30px;
    text-align: center;
    color: white;
}
.card-header h1 { margin: 0; font-size: calc(26px * var(--font-scale)); font-weight: 800; }
.card-header p { margin: 5px 0 0; opacity: 0.9; font-size: calc(15px * var(--font-scale)); }

.table-wrapper { padding: 20px; }

table { width: 100%; border-collapse: separate; border-spacing: 0; }

thead th {
    background: var(--table-head-bg);
    color: var(--table-head-text);
    padding: 15px;
    text-align: center;
    font-weight: 600;
    font-size: calc(14px * var(--font-scale));
    border-bottom: 2px solid rgba(255,255,255,0.05);
}

tbody tr { transition: background 0.2s; }
tbody tr:nth-child(even) { background: var(--row-even-bg); }
tbody tr:hover { background: var(--row-hover) !important; }

td {
    padding: 16px 10px;
    text-align: center;
    border-bottom: 1px solid rgba(255,255,255,0.03);
    font-size: calc(16px * var(--font-scale));
}

/* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø®ØµØµ */
.col-brand { color: var(--col-brand); font-weight: 600; }
.col-size { 
    color: var(--col-size); 
    font-weight: 800; 
    font-family: 'Segoe UI', sans-serif; /* Ù„Ù„Ø£Ø±Ù‚Ø§Ù… */
    font-size: calc(18px * var(--font-scale));
}
.col-price { 
    color: var(--col-price); 
    font-weight: 800; 
    font-size: calc(18px * var(--font-scale));
}
.col-status { color: var(--col-status); font-size: calc(14px * var(--font-scale)); }

.card-footer {
    padding: 15px;
    text-align: center;
    font-size: calc(12px * var(--font-scale));
    color: #64748b;
    border-top: 1px solid rgba(255,255,255,0.05);
    background: rgba(0,0,0,0.1);
}

/* Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
@media (max-width: 900px) {
    .app-container { grid-template-columns: 1fr; }
    .sidebar { height: auto; border-left: none; border-bottom: 1px solid var(--border); }
    .preview-area { padding: 20px 10px; }
}
</style>
</head>
<body>

<div class="app-container">
    
    <div class="sidebar">
        <h2>ğŸ› ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h2>
        
        <div class="control-group">
            <div class="group-title">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
            <textarea id="rawInput" placeholder="Ø§ÙƒØªØ¨ Ù‡Ù†Ø§.. Ù…Ø«Ø§Ù„:
Ø­Ø¬Ù… 50 Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬ Ø§Ù„Ø³Ø¹Ø± 400
Ø³ÙˆÙ†ÙŠ Ø­Ø¬Ù… 65 Ø³Ø¹Ø± 600"></textarea>
            <button class="btn-primary" onclick="generateTable()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ ğŸ”„</button>
        </div>

        <div class="control-group">
            <div class="group-title">Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø£Ø±Ù‚Ø§Ù…</div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø§Ù„Ù…Ø§Ø±ÙƒØ©</label>
                <input type="color" value="#e2e8f0" oninput="setVar('--col-brand', this.value)">
            </div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ù…</label>
                <input type="color" value="#f59e0b" oninput="setVar('--col-size', this.value)">
            </div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø§Ù„Ø³Ø¹Ø±</label>
                <input type="color" value="#22c55e" oninput="setVar('--col-price', this.value)">
            </div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø§Ù„Ø­Ø§Ù„Ø© (Ù…ØªÙˆÙØ±)</label>
                <input type="color" value="#94a3b8" oninput="setVar('--col-status', this.value)">
            </div>
        </div>

        <div class="control-group">
            <div class="group-title">Ø§Ù„Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¹Ø§Ù…</div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø±Ø£Ø³ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ø¨Ø¯Ø§ÙŠØ©)</label>
                <input type="color" value="#15803d" oninput="setVar('--header-gradient-1', this.value)">
            </div>
            <div class="setting-row">
                <label>Ù„ÙˆÙ† Ø±Ø£Ø³ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù†Ù‡Ø§ÙŠØ©)</label>
                <input type="color" value="#22c55e" oninput="setVar('--header-gradient-2', this.value)">
            </div>
            <div class="setting-row">
                <label>Ø®Ù„ÙÙŠØ© Ø§Ù„ÙƒØ§Ø±Øª</label>
                <input type="color" value="#1e293b" oninput="setVar('--card-bg', this.value)">
            </div>
            <div class="setting-row">
                <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø·ÙˆØ·</label>
                <input type="range" min="0.8" max="1.3" step="0.1" value="1" oninput="setVar('--font-scale', this.value)">
            </div>
        </div>

        <button class="btn-primary btn-success" onclick="downloadImage()">Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ“¸</button>
    </div>

    <div class="preview-area">
        <div class="price-card" id="captureTarget">
            <div class="card-header">
                <h1 contenteditable="true">Ø´Ø±ÙƒØ© Ø³ÙˆØ¨Ø± Ù…Ø§ÙƒØ³</h1>
                <p contenteditable="true">Ø¨ØºØ¯Ø§Ø¯ - ÙƒØ±Ø§Ø¯Ø© Ø®Ø§Ø±Ø¬  | 07711272744</p>
            </div>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ø§Ø±ÙƒØ©</th>
                            <th>Ø§Ù„Ø­Ø¬Ù… (Ø¨ÙˆØµØ©)</th>
                            <th>Ø§Ù„Ø³Ø¹Ø± (Ø¯.Ø¹)</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        </tbody>
                </table>
            </div>

            <div class="card-footer">
                ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨ØªØ§Ø±ÙŠØ®: <span id="currentDate"></span> â€¢ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØºÙŠÙŠØ±
            </div>
        </div>
    </div>

</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ§Ø±ÙŠØ®
    document.getElementById('currentDate').innerText = new Date().toLocaleDateString('ar-IQ');

    // Ø¯Ø§Ù„Ø© ØªØºÙŠÙŠØ± Ù…ØªØºÙŠØ±Ø§Øª CSS
    function setVar(name, value) {
        document.documentElement.style.setProperty(name, value);
    }

    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
    function normalizeNumbers(text){
        const map = {'Ù ':'0','Ù¡':'1','Ù¢':'2','Ù£':'3','Ù¤':'4','Ù¥':'5','Ù¦':'6','Ù§':'7','Ù¨':'8','Ù©':'9'};
        return text.replace(/[Ù -Ù©]/g, d => map[d]);
    }

    function formatPrice(num) {
        return new Intl.NumberFormat('en-US').format(num);
    }

    // Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
    function generateTable() {
        const input = document.getElementById("rawInput").value.trim();
        const body = document.getElementById("tableBody");
        body.innerHTML = "";

        if (!input) return;

        const lines = input.split("\n");

        lines.forEach(line => {
            let cleanLine = normalizeNumbers(line);
            if(cleanLine.trim() === "") return;

            // Regex:
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø­Ø¬Ù… (Ø±Ù‚Ù… ÙÙ‚Ø·)
            const sizeMatch = cleanLine.match(/(\d{2,})\s*(Ø¨ÙˆØµØ©|inch)?/i) || cleanLine.match(/Ø­Ø¬Ù…\s*(\d+)/);
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø³Ø¹Ø±
            const priceMatch = cleanLine.match(/(\d{2,})\s*(Ø§Ù„Ù|Ø£Ù„Ù)/) || cleanLine.match(/Ø³Ø¹Ø±\s*(\d+)/);

            if (sizeMatch && priceMatch) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø±ÙƒØ©
                let brand = cleanLine
                    .replace(sizeMatch[0], '') // Ø­Ø°Ù Ù†Øµ Ø§Ù„Ø­Ø¬Ù…
                    .replace(priceMatch[0], '') // Ø­Ø°Ù Ù†Øµ Ø§Ù„Ø³Ø¹Ø±
                    .replace(/Ø­Ø¬Ù…|Ø§Ù„Ø³Ø¹Ø±|Ø³Ø¹Ø±|Ø¨ÙˆØµØ©|Ø§Ù„Ù|Ø£Ù„Ù|Ø¯.Ø¹/g, '') // ØªÙ†Ø¸ÙŠÙ ÙƒÙ„Ù…Ø§Øª
                    .trim();
                
                brand = brand.replace(/^[-â€“â€”.]/, '').trim(); // ØªÙ†Ø¸ÙŠÙ Ø±Ù…ÙˆØ² Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
                if(brand.length < 2) brand = "Ø´Ø§Ø´Ø©";

                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td class="col-brand">${brand}</td>
                    <td class="col-size">${sizeMatch[1]}</td> 
                    <td class="col-price">${formatPrice(priceMatch[1])},000</td>
                    <td class="col-status">Ù…ØªÙˆÙØ±</td>
                `;
                // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø­Ø¬Ù… ÙŠØ¸Ù‡Ø± Ø±Ù‚Ù…Ø§Ù‹ ÙÙ‚Ø· (sizeMatch[1])
                // Ø§Ù„Ø­Ø§Ù„Ø© ØªØ¸Ù‡Ø± ÙƒÙ„Ù…Ø© "Ù…ØªÙˆÙØ±" ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† ØµØ­
                
                body.appendChild(tr);
            }
        });
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©
    function downloadImage() {
        const element = document.getElementById("captureTarget");
        
        html2canvas(element, {
            scale: 2.5, // Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹
            backgroundColor: null, // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¹Ù†ØµØ± Ù†ÙØ³Ù‡Ø§
            useCORS: true
        }).then(canvas => {
            const link = document.createElement('a');
            link.download = 'Price_List_' + Date.now() + '.png';
            link.href = canvas.toDataURL();
            link.click();
        });
    }

    // ØªØ´ØºÙŠÙ„ Ù…Ø¨Ø¯Ø¦ÙŠ
    window.onload = generateTable;
</script>

</body>
</html>
